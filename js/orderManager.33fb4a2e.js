(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["orderManager"],{"02cf":function(t,e,s){},1959:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"orderManager"}},[s("div",{staticClass:"title"},[t._v("訂單管理")]),s("b-row",{staticClass:"mb-5"},[s("b-col",{attrs:{cols:"3"}},[s("b-form-select",{attrs:{options:t.filteroptions},model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}})],1),s("b-col",{attrs:{cols:"9"}})],1),s("b-row",{staticClass:"firstcolborder"},[s("b-col",{staticClass:"d-flex justify-content-center",attrs:{cols:"3"}},[t._v("訂單編號")]),s("b-col",{staticClass:"d-flex justify-content-center",attrs:{cols:"3"}},[t._v("訂單日期")]),s("b-col",{staticClass:"d-flex justify-content-center",attrs:{cols:"3"}},[t._v("狀態")]),s("b-col",{staticClass:"d-flex justify-content-center",attrs:{cols:"2"}},[t._v("編輯")]),s("b-col",{staticClass:"d-flex justify-content-center",attrs:{cols:"1"}},[t._v("刪除")])],1),t._l(t.filterorders,(function(e,r){return s("b-row",{staticClass:"colBorder"},[s("b-col",{staticClass:"d-flex justify-content-center",attrs:{cols:"3"}},[t._v(t._s(e.identification))]),s("b-col",{staticClass:"d-flex justify-content-center",attrs:{cols:"3"}},[t._v(t._s(e.date))]),s("b-col",{staticClass:"d-flex justify-content-center",attrs:{cols:"3"}},[s("span",{staticClass:"sellColorNormal",class:{sellColor:"已付款"===e.orderStatus}},[t._v(t._s(e.orderStatus))])]),s("b-col",{staticClass:"d-flex justify-content-center",attrs:{cols:"2"}},[s("b-btn",{staticClass:"editbtn",attrs:{variant:"success"},on:{click:function(s){return t.showModel(e)}}},[s("font-awesome-icon",{attrs:{icon:["fas","edit"]}})],1)],1),s("b-col",{staticClass:"d-flex justify-content-center",attrs:{cols:"1"}},[s("b-btn",{staticClass:"delbtn d-flex justify-content-center",attrs:{variant:"danger"},on:{click:function(s){return t.showDelOrder(e,r)}}},[s("font-awesome-icon",{attrs:{icon:["fas","trash-alt"]}})],1)],1)],1)})),s("b-modal",{ref:"my-modal",attrs:{id:"confirmModel",size:"sm",centered:"","hide-header":"","hide-footer":""},model:{value:t.showConfirm,callback:function(e){t.showConfirm=e},expression:"showConfirm"}},[s("p",{staticClass:"text-center"},[t._v("確定要刪除此資料嗎?")]),s("div",{staticClass:"d-flex justify-content-center my-4",attrs:{id:"modal-footer"}},[s("b-button",{staticClass:"confirmBtn mr-5",attrs:{id:"show-btn",variant:"success"},on:{click:t.delOderCon}},[t._v("確認")]),s("b-button",{staticClass:"cancelBtn",attrs:{id:"show-btn",variant:"primary"},on:{click:t.closeModel}},[t._v("取消")])],1)]),s("b-modal",{ref:"my-modal",attrs:{id:"modal",size:"lg",title:"訂單資料","hide-header":"","hide-footer":""},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[s("form",{staticClass:"w-75 mx-auto",on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[s("div",{staticClass:"title"},[t._v("訂單資料")]),s("b-row",{staticClass:"justify-content-between"},[s("b-col",{attrs:{id:"orderInfo",cols:"auto"}},[s("b-row",{staticClass:"flex-column"},[s("b-col",{staticClass:"d-flex mb-2"},[s("span",{staticClass:"mr-3"},[t._v("訂單編號")]),s("span",[t._v(t._s(t.orderTemp.identification))])]),s("b-col",{staticClass:"d-flex mb-2"},[s("span",{staticClass:"mr-3"},[t._v("下訂日期")]),s("span",[t._v(t._s(t.orderTemp.date))])]),s("b-col",{staticClass:"d-flex mb-2"},[s("span",{staticClass:"mr-3"},[t._v("預定日期")]),s("span",[t._v(t._s(t.orderTemp.arriveDate))])]),s("b-col",{staticClass:"d-flex mb-2"},[s("label",{staticClass:"mr-3",attrs:{for:"payment"}},[t._v("付款方式")]),s("b-form-radio",{attrs:{id:"payment",value:"貨到付款",checked:""},model:{value:t.orderInfoTemp.payment,callback:function(e){t.$set(t.orderInfoTemp,"payment",e)},expression:"orderInfoTemp.payment"}},[t._v("貨到付款")])],1)],1)],1),s("b-col",{attrs:{id:"orderStatus",cols:"auto"}},[s("b-form-select",{class:{sellColor:"已付款"===t.orderStatus},attrs:{id:"status",options:t.options},model:{value:t.orderStatus,callback:function(e){t.orderStatus=e},expression:"orderStatus"}})],1)],1),s("hr"),s("div",{staticClass:"title"},[t._v("訂購人資料")]),s("b-row",{staticClass:"flex-column"},[s("b-col",{staticClass:"d-flex mb-2"},[s("label",{staticClass:"w-auto mr-3",attrs:{for:"name"}},[t._v("姓名")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.orderInfoTemp.userName,expression:"orderInfoTemp.userName"}],staticClass:"input w-75",attrs:{id:"name",type:"text",placeholder:"輸入"},domProps:{value:t.orderInfoTemp.userName},on:{input:function(e){e.target.composing||t.$set(t.orderInfoTemp,"userName",e.target.value)}}})]),s("b-col",{staticClass:"d-flex mb-2"},[s("label",{staticClass:"w-auto mr-3",attrs:{for:"email"}},[t._v("信箱")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.orderInfoTemp.userEmail,expression:"orderInfoTemp.userEmail"}],staticClass:"input w-75",attrs:{id:"email",type:"text",placeholder:"輸入"},domProps:{value:t.orderInfoTemp.userEmail},on:{input:function(e){e.target.composing||t.$set(t.orderInfoTemp,"userEmail",e.target.value)}}})]),s("b-col",{staticClass:"d-flex mb-2"},[s("label",{staticClass:"w-auto mr-3",attrs:{for:"tel"}},[t._v("電話")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.orderInfoTemp.userTel,expression:"orderInfoTemp.userTel"}],staticClass:"input w-75",attrs:{id:"tel",type:"text",placeholder:"輸入"},domProps:{value:t.orderInfoTemp.userTel},on:{input:function(e){e.target.composing||t.$set(t.orderInfoTemp,"userTel",e.target.value)}}})]),s("b-col",{staticClass:"d-flex mb-2"},[s("label",{staticClass:"w-auto mr-3",attrs:{for:"address"}},[t._v("地址")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.orderInfoTemp.userAddress,expression:"orderInfoTemp.userAddress"}],staticClass:"input w-75",attrs:{id:"address",type:"text",placeholder:"輸入"},domProps:{value:t.orderInfoTemp.userAddress},on:{input:function(e){e.target.composing||t.$set(t.orderInfoTemp,"userAddress",e.target.value)}}})]),s("b-col",{staticClass:"d-flex mb-4"},[s("label",{staticClass:"w-auto mr-3",attrs:{for:"other"}},[t._v("備註")]),s("b-form-textarea",{staticClass:"input w-75",attrs:{id:"other",type:"text",placeholder:"輸入"},model:{value:t.orderInfoTemp.other,callback:function(e){t.$set(t.orderInfoTemp,"other",e)},expression:"orderInfoTemp.other"}})],1)],1),s("hr"),s("div",{staticClass:"title"},[t._v("訂購商品資料")]),t._l(t.orderCartTemps,(function(e,r){return s("b-row",{staticClass:"mb-2"},[s("b-col",{attrs:{cols:"3"}},[s("span",{staticClass:"proBig"},[t._v(t._s(e.name))]),s("span",{staticClass:"proSmall"},[t._v("NT$ "+t._s(e.price))])]),s("b-col",{staticClass:"text-center",attrs:{cols:"2"}},[s("span",[t._v("x "+t._s(e.amount))])]),s("b-col",{attrs:{cols:"3"}}),s("b-col",{staticClass:"text-center",attrs:{cols:"3"}},[s("span",{staticClass:"price"},[t._v("NT$ "+t._s(e.price*e.amount))])]),s("b-col",{staticClass:"text-right",attrs:{cols:"1"}},[s("b-button",{staticClass:"delbtn",attrs:{id:"show-btn",variant:"danger"},on:{click:function(e){return t.delOrderPro(r)}}},[s("span",[t._v("x")])])],1)],1)})),s("div",{staticClass:"d-flex justify-content-center my-4",attrs:{id:"modal-footer"}},[s("b-button",{staticClass:"confirmBtn mr-5",attrs:{id:"show-btn",variant:"success"},on:{click:t.updateOrder}},[t._v("確認")]),s("b-button",{staticClass:"cancelBtn",attrs:{id:"show-btn",variant:"primary"},on:{click:t.closeModel}},[t._v("取消")])],1)],2)])],2)},a=[],o=(s("4de4"),s("7db0"),s("a434"),{name:"orderManager",data:function(){return{orders:[],show:!1,showConfirm:!1,tempdel:{},tempdelIndex:0,orderTemp:{},orderInfoTemp:{},orderCartTemps:[],orderStatus:"",selected:"全部",filteroptions:[{value:"全部",text:"全部"},{value:"未付款",text:"未付款"},{value:"已付款",text:"已付款"}],options:[{value:"未付款",text:"未付款"},{value:"已付款",text:"已付款"}]}},methods:{showDelOrder:function(t,e){this.showConfirm=!0,this.tempdel=t,this.tempdelIndex=e},showModel:function(t){this.show=!0,this.orderTemp=t,this.orderInfoTemp=Object.assign({},t.orderInfo[0]),this.orderCartTemps=Object.assign([],t.cartInfo),this.orderStatus=t.orderStatus},closeModel:function(){this.show=!1,this.showConfirm=!1},delOderCon:function(){var t=this;this.axios.delete("https://japanpan.herokuapp.com/orders/"+this.tempdel._id).then((function(e){e.data.success?(t.orders.splice(t.tempdelIndex,1),t.tempdel={},t.tempdelIndex=0,t.showConfirm=!1):t.$swal({icon:"error",title:"錯誤",text:e.data.message})})).catch((function(e){t.$swal({icon:"error",title:"錯誤",text:e.response.data.message})}))},delOrderPro:function(t){this.orderCartTemps.splice(t,1)},delOrder:function(t,e){var s=this;this.axios.delete("https://japanpan.herokuapp.com/orders/"+t._id).then((function(t){t.data.success?s.orders.splice(e,1):s.$swal({icon:"error",title:"錯誤",text:t.data.message})})).catch((function(t){s.$swal({icon:"error",title:"錯誤",text:t.response.data.message})}))},updateOrder:function(){var t=this,e={userId:this.orderTemp.userId,date:this.orderTemp.todayDate,arriveDate:this.orderTemp.arriveDate,orderInfo:this.orderInfoTemp,cartInfo:this.orderCartTemps,orderStatus:this.orderStatus};this.axios.patch("https://japanpan.herokuapp.com/orders/"+this.orderTemp._id,e).then((function(e){if(e.data.success){var s=t.filterorders.find((function(e){return e._id===t.orderTemp._id}));s.orderInfo[0]=t.orderInfoTemp,s.cartInfo=t.orderCartTemps,s.orderStatus=t.orderStatus,t.show=!1}else t.$swal({icon:"error",title:"錯誤",text:e.data.message})})).catch((function(e){t.$swal({icon:"error",title:"錯誤",text:e.response.data.message})}))}},mounted:function(){var t=this;this.axios.get("https://japanpan.herokuapp.com/orders/").then((function(e){t.orders=e.data.result.reverse()}))},computed:{filterorders:function(){var t=this;return this.orders.filter((function(e){return"全部"===t.selected?e:e.orderStatus===t.selected}))}}}),n=o,l=(s("5acf"),s("2877")),i=Object(l["a"])(n,r,a,!1,null,"fad53d48",null);e["default"]=i.exports},"4de4":function(t,e,s){"use strict";var r=s("23e7"),a=s("b727").filter,o=s("1dde"),n=s("ae40"),l=o("filter"),i=n("filter");r({target:"Array",proto:!0,forced:!l||!i},{filter:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},"5acf":function(t,e,s){"use strict";s("02cf")}}]);
//# sourceMappingURL=orderManager.33fb4a2e.js.map